expose:
  Annotations:
    helm.sh/hook: post-install,post-upgrade
    helm.sh/hook-delete-policy: hook-succeeded
  config:
    exposer: Ingress
    http: true
    tlsacme: false

cleanup:
  Args:
    - --cleanup
  Annotations:
    helm.sh/hook: pre-delete
    helm.sh/hook-delete-policy: hook-succeeded

netflix-conductor:
  image:
    preview_repository:
    preview_tag:
    pullPolicy: IfNotPresent
  redis_host: preview-redis-master
  elasticsearch_host: preview-elasticsearch-client

  nameOverride: "conductor"
  fullnameOverride: "netflix-conductor"

  server:
    ingress:
      annotations:
        fabric8.io/expose: "true"
        fabric8.io/ingress.annotations: "kubernetes.io/ingress.class: nginx"
    image:
      preview_repository_server:
      preview_tag_server:
      pullPolicy: IfNotPresent
    loadSamples: true
    newrelic:
      enabled: false
      tracing:
        enabled: false
    resources:
      limits:
        # We'r setting Xms = Xmx anyway, whichever the amount we know conductor will be comfortable with.
        memory: 4.5Gi
      requests:
        cpu: 1
        memory: 4.5Gi
  ui:
    ingress:
      annotations:
        fabric8.io/expose: "true"
        fabric8.io/ingress.annotations: "kubernetes.io/ingress.class: nginx"

    image:
      preview_repository_ui:
      preview_tag_ui:
      pullPolicy: IfNotPresent

    resources:
      limits:
        memory: 100Mi
      requests:
        cpu: 10m
        memory: 100Mi

  # Not needed for preview but commented as a reminder to fix preview ingress

  # ingress:
  #   server:
  #     enabled: false
  #     host: "server.conductor.dev.cluster.foxsports-gitops-prod.com.au"
  #   ui:
  #     enabled: false
  #     host: "ui.conductor.dev.cluster.foxsports-gitops-prod.com.au"

  elasticsearch:
    enabled: true
    host: preview-elasticsearch-client
    indexName: conductor

  redis:
    enabled: false

  mysql:
    enabled: true
    host: preview-mysql
    username: conductor
    password: ConductorMysqlPassword
    dbName: conductor



# Add the following and change enabled to true if external es required
elasticsearch:
  enabled: true
   appVersion: "5.6"
   image:
     repository: elasticsearch
     tag: "5.6"
  # cluster:
  #   name: foxsports_conductor_elasticsearch_cluster
  #   additionalJavaOpts: -XX:MaxMetaspaceSize=256m
  #   plugins:
  #   - x-pack # Needs to be installed for x-pack options to work even though they are all false by default...
  #   config:
  #     thread_pool.search.queue_size: 2000
  # master:
  #   replicas: 2
  #   persistence:
  #     enabled: false
  #   resources:
  #     limits:
  #       memory: "1Gi"
  #     requests:
  #       cpu: "200m"
  #       memory: "1Gi"       
  # data: 
  #   persistence: 
  #     enabled: false      
  # client:
  #   exposeTransportPort: true
  #   resources:
  #     limits:
  #       memory: "1Gi"
  #     requests:
  #       cpu: "100m"
  #       memory: "1Gi"
  #   ingress:
  #     enabled: false
  # ing_service: #responsible to expose the ing
  #   name: es-ing-service
  #   type: ClusterIP
  #   externalPort: 80
  #   internalPort: 9200
  #   annotations:
  #     fabric8.io/expose: "true"
  #     fabric8.io/ingress.annotations: "kubernetes.io/ingress.class: nginx"

# Add the following and change enabled to true if external redis required
redis:
  enabled: false

# # Add the following and change enabled to true if external mysql required
mysql:
  enabled: true
  mysqlRootPassword: pass
  mysqlUser: conductor
  mysqlPassword: ConductorMysqlPassword
  username: conductor
  password: ConductorMysqlPassword
  mysqlDatabase: conductor
  ## ref: https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services---service-types
  service:
    annotations:
      fabric8.io/expose: "true"
      fabric8.io/ingress.annotations: "kubernetes.io/ingress.class: nginx"
    type: ClusterIP
    port: 3306